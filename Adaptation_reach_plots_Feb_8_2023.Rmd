
#Setup and Data Import

```{r}
rm(list = ls())

library(tidyr)
library(dplyr)
library(ggplot2)
library(pracma)
library(plotrix)

'%+%' <- ggplot2::'%+%'

#Data separated for storage on GitHub repository
df1 <- read.csv(file = "testmybrain_data_30Dec2022_part_1.csv")
df2 <- read.csv(file = "testmybrain_data_30Dec2022_part_2.csv")
df3 <- read.csv(file = "testmybrain_data_30Dec2022_part_3.csv")
df4 <- read.csv(file = "testmybrain_data_30Dec2022_part_4.csv")
df5 <- read.csv(file = "testmybrain_data_30Dec2022_part_5.csv")
df6 <- read.csv(file = "testmybrain_data_30Dec2022_part_6.csv")

#Binding split data
raw.data<- do.call("rbind", list(df1, df2, df3, df4, df5, df6))


#Data from first-time participants selecting the shortest version of the task
ft.data <- raw.data %>% 
  filter(repeat. == "First Time") %>%
  filter(gameIndex == "easy") %>%
  filter(numtar == 1) %>%
  filter(TN <= 90) %>%
  mutate(mov_avg = movavg(HandFlip, 3, type = c('s'))) %>%
  mutate(variability = abs(mov_avg-HandFlip))

demo.vars <- ft.data %>% filter(TN > 1 & TN <= 30) %>%
  group_by(Subject.ID,
           Age, 
           Sleep, 
           ComputerUsage,
           Handedness,
           education, 
           rating, 
           mousetype, 
           racialorigin, 
           sex, 
           vision, 
           clumsy, 
           videogames, 
           major,
           browsertype,
           screensize,
           cardinal,
           CCW,
           NeuroDisease) %>%
  
  dplyr::summarise(RT_mean_baseline = mean(RT, na.rm = TRUE),
                   MT_mean_baseline = mean(MT, na.rm = TRUE),
                   ST_mean_baseline = mean(ST, na.rm = TRUE),
                   Var_sum_baseline = sum(variability, na.rm = TRUE))
```

#Histograms

```{r}

mousedem <- ft.data %>%
  mutate(
    mousetype = case_when(
      mousetype == 'idk' ~ "other",
      mousetype == 'trackpad' ~ "track pad",
      mousetype == 'trackball' ~ "track ball",
      mousetype == 'optical' ~ "optical"
    )
  ) %>%
  filter(TN == 1) %>%
  ggplot(aes(x = mousetype, fill = as.factor(cyl))) +
  theme_minimal() +
  geom_bar(fill = rgb(0.1, 0.4, 0.5, 0.7)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.95))

sexdem <- ft.data %>%
  filter(TN == 1) %>%
  ggplot(aes(x = sex, fill = as.factor(cyl))) +
  theme_minimal() +
  geom_bar(fill = rgb(0.1, 0.4, 0.5, 0.7)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.95))
sexdem


racedem <- ft.data %>%
  filter(TN == 1) %>%
  ggplot(aes(x = racialorigin, fill = as.factor(cyl))) +
  theme_minimal() +
  geom_bar(fill = rgb(0.1, 0.4, 0.5, 0.7)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.95))
racedem


handdem <- ft.data %>%
  mutate(
    Handedness = case_when(
      Handedness == 'lefth' ~ "lefty",
      Handedness == 'righth' ~ "righty",
      Handedness == 'bothh' ~ "ambi."
    )
  ) %>%
  filter(TN == 1) %>%
  ggplot(aes(x = Handedness, fill = as.factor(cyl))) +
  theme_minimal() +
  geom_bar(fill = rgb(0.1, 0.4, 0.5, 0.7)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.95))
handdem

```

#Core plots 

```{r}
p1 <- ft.data %>% 
  group_by(TN, Block, FB) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) ) %>%
  ggplot(aes(x = TN, y = Hand_mean, group = factor(Block), shape = factor(FB), color = )) + 
  annotate(x = c(0, 0, 0, 90.5), 
           xend = c(90.5, 90.5, 90.5, 90.5), 
           y = c(0, 45, 0, 0), 
           yend = c(0, 45, 0, 0), alpha= .5, color = 'light grey', 'segment') +
  theme_minimal() +
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.25) +
  geom_point(size = 0.5) +
  scale_x_continuous(breaks = c(0, 30, 84, 90) ) + 
  geom_vline(xintercept=c(30.5, 84.5, 90.5), linetype="longdash", alpha = .7, color = 'lightgrey') +
  scale_y_continuous(breaks = seq(-45, 45, 15) ) +
  scale_colour_brewer(palette = "Set1") +
  scale_shape_manual(values=c(1, 16), guide = FALSE) + 
  labs(x= 'Trial #', y = 'Hand Angle (°)')
p1

```

#Savings

```{r}
ft.data.wrepeat <- raw.data %>%        
  filter(gameIndex == "easy") %>%
  filter(numtar == 1) %>%
  filter(TN <= 90)

repeatdata <- ft.data.wrepeat %>% 
  mutate(newrepeat = dplyr::if_else(repeat. == 'First Time', 'Naive', 'Experienced') ) %>% 
  group_by(TN, Block, FB, newrepeat) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

repeatplot <-  p1 %+% repeatdata + aes(fill = factor(newrepeat), group = interaction(factor(Block), factor(newrepeat))) + 
  geom_point(aes(color = factor(newrepeat)), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  labs(fill = '', color = '')+
  scale_colour_manual("",values=c('orange', 'deepskyblue4'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4'))
repeatplot

ft.data.wrepeat %>% 
  filter(TN == 1) %>%
  mutate(newrepeat = dplyr::if_else(repeat. == 'First Time', 'Naive', 'Experienced') ) %>%
  ggplot(aes(x=newrepeat, fill=as.factor(cyl))) +
  theme_minimal() +
  geom_bar( fill=rgb(0.1,0.4,0.5,0.7) ) +
  scale_y_continuous(breaks = c(0, 100, 200, 300, 400, 500)) + 
  labs(x= 'Repeat Users')


```

#Target Number

```{r}

mult_targ <- raw.data %>%
  filter(numtar == 1 & TN <91 | 
           numtar == 2 & TN <181) %>% 
  mutate(cycle = ceiling(TN/numtar)) %>%
  group_by(Subject.ID, cycle, Block, FB, numtar) %>%
  dplyr::summarise(HandFlip = mean(HandFlip, na.rm = TRUE))

p6 <- mult_targ %>% 
  group_by(cycle, Block, FB, numtar) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) ) %>%
  ggplot(aes(x = cycle, y = Hand_mean, group = factor(Block), shape = factor(FB), color = )) + 
  annotate(x = c(0, 0, 0, 90.5), 
           xend = c(90.5, 90.5, 90.5, 90.5), 
           y = c(0, 45, 0, 0), 
           yend = c(0, 45, 0, 0), alpha= .5, color = 'light grey', 'segment') +
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.25) +
  geom_point(size = 0.5) +
  scale_x_continuous(breaks = c(0, 30, 84, 90) ) + 
  geom_vline(xintercept=c(30.5, 84.5, 90.5), linetype="longdash", alpha = .7, color = 'lightgrey') +
  scale_y_continuous(breaks = seq(-45, 45, 15) ) +
  #scale_colour_brewer(palette = "Set1") +
  scale_shape_manual(values=c(1, 16), guide = FALSE) + 
  labs(x= 'Cycle #', y = 'Hand Angle (°)')+
  scale_colour_manual("",values=c('orange', 'deepskyblue4'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4'))

targdata <- mult_targ %>%
  filter(numtar <= 2) %>%
  group_by(cycle, Block, FB, numtar) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

targplot <- p6 %+% targdata + aes(fill = factor(numtar), group = interaction(factor(Block), factor(numtar))) + 
  geom_point (aes(color = factor(numtar)), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  labs(fill = '', color = '') +
  scale_colour_manual("",values=c('orange', 'deepskyblue4'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4'))
targplot

```


#Cross-correlation between phases

```{r}
my.pro.data.phase <- ft.data %>% 
  mutate(phase = case_when(TN >= 31 & TN <= 40 ~ "Early", 
                           TN >= 74 & TN <= 84 ~ "Late", 
                           TN >= 85 & TN <= 90 ~ "Aftereffect")) %>%
  group_by(Subject.ID, phase) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE)) %>% 
  drop_na() 

my.pro.data.phase$phase <- factor(my.pro.data.phase$phase, levels = c("Early", "Late", "Aftereffect"))

myafterlatecor <- my.pro.data.phase %>% 
  spread(phase, Hand_mean) %>%
  ggplot(aes(x = Aftereffect, y = Late)) + 
  geom_point(color = "grey", alpha = 0.2) + 
  #stat_cor(method = "spearman") +
  geom_smooth(method = "lm", color = "black", se = FALSE, alpha = 0.5, size = 0.2) +
  theme(strip.background = element_blank(),
  strip.text.x = element_blank()) +
  coord_capped_cart(ylim = c(-80, 80), xlim = c(-80, 80)) + 
  scale_x_continuous(breaks = c(-45, 0, 45)) + 
  scale_y_continuous(breaks = c(-45, 0, 45)) + 
  labs(x  = "Aftereffect (°)", y = "Late adapt (°)") +
  theme_minimal()
myafterlatecor

myafterearlycor <- my.pro.data.phase %>% 
  spread(phase, Hand_mean) %>%
  ggplot(aes(x = Aftereffect, y = Early)) + 
  geom_point(color = "grey", alpha = 0.2) + 
  #stat_cor(method = "spearman") +
  geom_smooth(method = "lm", color = "black", se = FALSE, alpha = 0.5, size = 0.2) +
  theme(strip.background = element_blank(),
  strip.text.x = element_blank()) +
  coord_capped_cart(ylim = c(-80, 80), xlim = c(-80, 80)) + 
  scale_x_continuous(breaks = c(-45, 0, 45)) + 
  scale_y_continuous(breaks = c(-45, 0, 45)) + 
  labs(x  = "Aftereffect (°)", y = "Early adapt (°)")+
  theme_minimal()

myafterearlycor

myearlylatecor <- my.pro.data.phase %>% 
  spread(phase, Hand_mean) %>%
  ggplot(aes(x = Early, y = Late)) + 
  geom_point(color = "grey", alpha = 0.2) + 
  #stat_cor(method = "spearman") +
  geom_smooth(method = "lm", color = "black", se = FALSE, alpha = 0.5, size = 0.2) +
  theme(strip.background = element_blank(),
  strip.text.x = element_blank()) +
  coord_capped_cart(ylim = c(-80, 80), xlim = c(-80, 80)) + 
  scale_x_continuous(breaks = c(-45, 0, 45)) + 
  scale_y_continuous(breaks = c(-45, 0, 45)) + 
  labs(x  = "Early adapt (°)", y = "Late adapt (°)") +
  theme_minimal()
myearlylatecor
```


#Split-half Reliability R-squared

```{r}

eo_early_Rsqr <- ft.data %>%
  filter(TN >=31 & TN <=42) %>%
  dplyr::mutate(ID = dplyr::row_number()) %>%
  dplyr::mutate(ID = ifelse(is.even(ID), ID - 1, ID)) %>%
  dplyr::group_by(ID, Subject.ID) %>%
  dplyr::summarise(Even = case_when(is.even(dplyr::row_number()) ~ HandFlip),
                   Odd = case_when(is.even(dplyr::row_number()) == FALSE ~ HandFlip))%>%
  dplyr::group_by(Subject.ID) %>%
  dplyr::summarise(Even_mean = mean(Even, na.rm = TRUE),
                   Odd_mean = mean(Odd, na.rm = TRUE)) %>%
  na.omit() %>%
  mutate(one = 1) %>%
  dplyr::group_by(one)

early.Rsqr <- summary(lm(Even_mean~Odd_mean, eo_early_Rsqr))$r.squared
early.Rsqr

eo_late_Rsqr <- ft.data %>%
  filter(TN >=73 & TN <=84) %>%
  dplyr::mutate(ID = dplyr::row_number()) %>%
  dplyr::mutate(ID = ifelse(is.even(ID), ID - 1, ID)) %>%
  dplyr::group_by(ID, Subject.ID) %>%
  dplyr::summarise(Even = case_when(is.even(dplyr::row_number()) ~ HandFlip),
                   Odd = case_when(is.even(dplyr::row_number()) == FALSE ~ HandFlip))%>%
  dplyr::group_by(Subject.ID) %>%
  dplyr::summarise(Even_mean = mean(Even, na.rm = TRUE),
                   Odd_mean = mean(Odd, na.rm = TRUE)) %>%
  na.omit() %>%
  mutate(one = 1) %>%
  dplyr::group_by(one)

late.Rsqr <- summary(lm(Even_mean~Odd_mean, eo_late_Rsqr))$r.squared
late.Rsqr

eo_after_Rsqr <- ft.data %>%
  filter(TN >=85 & TN <=90) %>%
  dplyr::mutate(ID = dplyr::row_number()) %>%
  dplyr::mutate(ID = ifelse(is.even(ID), ID - 1, ID)) %>%
  dplyr::group_by(ID, Subject.ID) %>%
  dplyr::summarise(Even = case_when(is.even(dplyr::row_number()) ~ HandFlip),
                   Odd = case_when(is.even(dplyr::row_number()) == FALSE ~ HandFlip)) %>%
  dplyr::group_by(Subject.ID) %>%
  dplyr::summarise(Even_mean = mean(Even, na.rm = TRUE),
                   Odd_mean = mean(Odd, na.rm = TRUE)) %>%
  na.omit() %>%
  mutate(one = 1) %>%
  dplyr::group_by(one)

ae.Rsq <- summary(lm(Even_mean~Odd_mean, eo_after_Rsqr))$r.squared
ae.Rsq 

```


#Plotting Split-half Reliability 

```{r}

eo_e <- ft.data %>%
  filter(TN >=31 & TN <=42) %>%
  dplyr::mutate(ID = dplyr::row_number()) %>%
  dplyr::mutate(ID = ifelse(is.even(ID), ID - 1, ID)) %>%
  dplyr::group_by(ID, Subject.ID) %>%
  dplyr::summarise(Even = case_when(is.even(dplyr::row_number()) ~ HandFlip),
                   Odd = case_when(is.even(dplyr::row_number()) == FALSE ~ HandFlip))%>%
  dplyr::group_by(Subject.ID) %>%
  dplyr::summarise(Even_mean = mean(Even, na.rm = TRUE),
                   Odd_mean = mean(Odd, na.rm = TRUE))

eo_l <- ft.data %>%
  filter(TN >=73 & TN <=84) %>%
  dplyr::mutate(ID = dplyr::row_number()) %>%
  dplyr::mutate(ID = ifelse(is.even(ID), ID - 1, ID)) %>%
  dplyr::group_by(ID, Subject.ID) %>%
  dplyr::summarise(Even = case_when(is.even(dplyr::row_number()) ~ HandFlip),
                   Odd = case_when(is.even(dplyr::row_number()) == FALSE ~ HandFlip))%>%
  dplyr::group_by(Subject.ID) %>%
  dplyr::summarise(Even_mean = mean(Even, na.rm = TRUE),
                   Odd_mean = mean(Odd, na.rm = TRUE)) 
eo_a <- ft.data %>%
  filter(TN >=85 & TN <=90) %>%
  dplyr::mutate(ID = dplyr::row_number()) %>%
  dplyr::mutate(ID = ifelse(is.even(ID), ID - 1, ID)) %>%
  dplyr::group_by(ID, Subject.ID) %>%
  dplyr::summarise(Even = case_when(is.even(dplyr::row_number()) ~ HandFlip),
                   Odd = case_when(is.even(dplyr::row_number()) == FALSE ~ HandFlip)) %>%
  dplyr::group_by(Subject.ID) %>%
  dplyr::summarise(Even_mean = mean(Even, na.rm = TRUE),
                   Odd_mean = mean(Odd, na.rm = TRUE))


eo_e$ID <- "Early"
eo_l$ID <- "Late"
eo_a$ID <- "After"

eo_combi <- rbind(rbind(eo_l, eo_a), eo_e)

alph <- .1
strok <- 1

eo_early_noiseplot <- eo_combi%>%filter(ID == "Early") %>%
  ggplot(aes(x = Even_mean, y = Odd_mean)) +
  geom_point( alpha = alph, size = 1, stroke = strok, shape = 1) +
  xlab("Averaged Even Reach\n (per person per phase)") +
  ylab("\nAveraged Odd Reach\n (per person per phase)") + 
  theme(legend.position = ' ',
        axis.line = element_line(color = "black"),
        panel.background = element_blank()) +
  geom_abline(intercept = 0, slope = 1, alpha = .8) +
  scale_x_continuous(limits = c(-90, 90), breaks = seq(-90, 90, 45)) +
  scale_y_continuous(limits = c(-90, 90), breaks = seq(-90, 90, 45)) + 
  theme_minimal()
eo_early_noiseplot

eo_late_noiseplot <- eo_combi%>%filter(ID == "Late") %>%
  ggplot(aes(x = Even_mean, y = Odd_mean)) +
  geom_point( alpha = alph, size = 1, stroke = strok, shape = 1) +
  xlab("Averaged Even Reach\n (per person per phase)") +
  ylab("\nAveraged Odd Reach\n (per person per phase)") + 
  theme(legend.position = ' ',
        axis.line = element_line(color = "black"),
        panel.background = element_blank()) +
  geom_abline(intercept = 0, slope = 1, alpha = .8) +
  scale_x_continuous(limits = c(-90, 90), breaks = seq(-90, 90, 45)) +
  scale_y_continuous(limits = c(-90, 90), breaks = seq(-90, 90, 45)) + 
  theme_minimal()

eo_late_noiseplot

eo_after_noiseplot <- eo_combi%>%filter(ID == "After") %>%
  ggplot(aes(x = Even_mean, y = Odd_mean)) +
  geom_point(alpha = alph, size = 1, stroke = strok, shape = 1) +
  xlab("Averaged Even Reach\n (per person per phase)") +
  ylab("\nAveraged Odd Reach\n (per person per phase)") + 
  theme(legend.position = ' ',
        axis.line = element_line(color = "black"),
        panel.background = element_blank()) +
  geom_abline(intercept = 0, slope = 1, alpha = .8) +
  scale_x_continuous(limits = c(-90, 90), breaks = seq(-90, 90, 45)) +
  scale_y_continuous(limits = c(-90, 90), breaks = seq(-90, 90, 45)) + 
  theme_minimal()

eo_after_noiseplot

```



#Age 

```{r}

agedata <- ft.data %>% 
  mutate(Age_Group = case_when(Age <= 40 ~ '9-40', 
                            Age > 40 ~ '41-100')) %>%
  group_by(TN, Block, FB, Age_Group) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

ageplot <- p1 %+% agedata + aes(fill = factor(Age_Group), group = interaction(factor(Block), factor(Age_Group))) + 
  geom_point (aes(color = factor(Age_Group)), size = 0.5) + 
  #geom_line(aes(color = factor(Age_Group))) +
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  labs(fill = '', color = '')+
  scale_colour_manual("",values=c('orange', 'deepskyblue4'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4'))
ageplot

``` 

#Rating

```{r}

ratingdata <- ft.data %>%
  group_by(TN, Block, FB, rating) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE))

ratingplot <-p1 %+% ratingdata + aes(fill = rating, group = interaction(factor(Block), rating)) + 
  geom_point(aes(color = rating), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05)+ 
  labs(fill = 'Rating', color = 'Rating')+
  scale_color_gradient(low = "grey62", high = "deepskyblue4") + 
  scale_fill_gradient(low = "grey62", high = "deepskyblue4") +
  theme(axis.text.x = element_text(angle = 45, hjust = 0.95))

ratingplot

```

#Movement Time

```{r}

MT_subs <- demo.vars
MT_subs$Above<- ifelse(MT_subs$MT_mean_baseline > median(MT_subs$MT_mean_baseline), "Above Median (slower)", "Below Median (faster)")

MTdata <- na.omit(full_join(ft.data, MT_subs, by = c("Subject.ID"))) %>% 
  group_by(TN, Block, FB, Above) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

MTplot <- p1 %+% MTdata + aes(fill = factor(Above), group = interaction(factor(Block), factor(Above))) + 
  geom_point (aes(color = factor(Above)), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  labs(fill = '', color = '')+
  scale_colour_manual("",values=c('orange', 'deepskyblue4'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4'))
MTplot

```

#Vision

```{r}

visiondata <- ft.data %>% 
  group_by(TN, Block, FB, vision) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

vision_plot <- p1 %+% visiondata + aes(fill = factor(vision), group = interaction(factor(Block), factor(vision))) + 
  geom_point(aes(color = factor(vision)), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  labs(fill = 'Corrected Vision', color = 'Corrected Vision')+
  scale_colour_manual("",values=c('orange', 'deepskyblue4'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4'))
vision_plot


```

#Sex

```{r}

sexdata <- ft.data %>% 
  filter(sex != "other") %>%
  group_by(TN, Block, FB, sex) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

sexplot <- p1 %+% sexdata + aes(fill = sex, group = interaction(factor(Block), sex)) + 
  geom_point (aes(color = sex), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem, fill = sex), alpha = 0.1) +
  labs(fill = '', color = '') +
  scale_colour_manual("",values=c('orange', 'deepskyblue4'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4'))
sexplot

```

#Variability

```{r}

var_subs <- demo.vars
var_subs$Above<- ifelse(var_subs$Var_sum_baseline > median(var_subs$Var_sum_baseline), "Above Median", "Below Median")


vardata <- na.omit(full_join(ft.data, var_subs, by = c("Subject.ID"))) %>% 
  group_by(TN, Block, FB, Above) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

varplot <- p1 %+% vardata + aes(fill = factor(Above), group = interaction(factor(Block), factor(Above))) + 
  geom_point (aes(color = factor(Above)), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  labs(fill = '', color = '')+
  scale_colour_manual("",values=c('orange', 'deepskyblue4'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4'))
varplot

```

#Education

Scale is as follows:
none of the above: 0
primary school: 1
middle school: 2
secondary school: 3
college: 4
technical school: 4
bachelor: 5
graduate: 6

```{r}

educationdata <- ft.data %>%
  group_by(TN, Block, FB, education) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) ) %>%
  filter(education >=1) #omitting those that chose "none of the above" for clarity

eduplot <- p1 %+% educationdata + aes(fill = education, group = interaction(factor(Block), education)) + 
  geom_point(aes(color = education), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05)+
  geom_point(data = educationdata, aes(color = education), size = 0.5) + 
  geom_ribbon(data = educationdata ,aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.1)+
  labs(fill = '', color = '')+
  scale_color_gradient(low = "grey62", high = "deepskyblue4") + 
  scale_fill_gradient(low = "grey62", high = "deepskyblue4")

eduplot
```

#Search time

```{r}

ST_subs <- demo.vars
ST_subs$Above<- ifelse(ST_subs$ST_mean_baseline > median(ST_subs$ST_mean_baseline), "Above Median", "Below Median")


STdata <- na.omit(full_join(ft.data, ST_subs, by = c("Subject.ID"))) %>% 
  group_by(TN, Block, FB, Above) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

STplot <- p1 %+% STdata + aes(fill = factor(Above), group = interaction(factor(Block), factor(Above))) + 
  geom_point (aes(color = factor(Above)), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  labs(fill = '', color = '')+
  scale_colour_manual("",values=c('orange', 'deepskyblue4'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4'))
STplot

```

#Target Angle

```{r}

targetdata <- ft.data %>% 
  mutate(cardinal = dplyr::if_else(ti %in% c(0, 90, 180, 270), 'Cardinal Targets', 'Diagonal Targets')) %>%
  group_by(TN, Block, FB, cardinal) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

cardinalplot <- p1 %+% targetdata + aes(fill = factor(cardinal), group = interaction(factor(Block), factor(cardinal))) + 
  geom_point (aes(color = factor(cardinal)), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05)+ 
  labs(fill = '', color = '')+
  scale_colour_manual("",values=c('orange', 'deepskyblue4'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4'))
cardinalplot

```

#Reaction time

```{r}

RT_subs <- demo.vars
RT_subs$Above<- ifelse(RT_subs$RT_mean_baseline > median(RT_subs$RT_mean_baseline), "Above Median", "Below Median")


RTdata <- na.omit(full_join(ft.data, RT_subs, by = c("Subject.ID"))) %>% 
  group_by(TN, Block, FB, Above) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

RTplot <- p1 %+% RTdata + aes(fill = factor(Above), group = interaction(factor(Block), factor(Above))) + 
  geom_point (aes(color = factor(Above)), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  labs(fill = '', color = '')+
  scale_colour_manual("",values=c('orange', 'deepskyblue4'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4'))
RTplot

```

#Neurological Pathology

```{r}

neurodata <- ft.data %>% na.omit() %>%
  group_by(TN, Block, FB, NeuroDisease) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

neuroplot <- p1 %+% neurodata + aes(fill = as.factor(NeuroDisease), group = interaction(factor(Block), as.factor(NeuroDisease))) + 
  geom_point (aes(color = as.factor(NeuroDisease)), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem, fill = as.factor(NeuroDisease)), alpha = 0.1) +
  labs(fill = '', color = '') +
  scale_colour_manual("",values=c('orange', 'deepskyblue4'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4'))
neuroplot

```

#Mouse

```{r}
mousedata <- ft.data %>% 
  filter(mousetype %in% c('trackpad', 'optical')) %>%
  mutate(mousetype = dplyr::if_else(mousetype == 'optical', 'Mouse', 'Trackpad')) %>%
  group_by(TN, Block, FB, mousetype) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

mouseplot <- p1 %+% mousedata + aes(fill = factor(mousetype), group = interaction(factor(Block), factor(mousetype))) + 
  geom_point (aes(color = factor(mousetype)), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  labs(fill = '', color = '')+
  scale_colour_manual("",values=c('orange', 'deepskyblue4'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4'))
mouseplot

```

#Handedness

```{r}

handeddata <- ft.data %>% 
  group_by(TN, Block, FB, Handedness) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

handed_plot <- p1 %+% handeddata + aes(fill = Handedness, group = interaction(factor(Block), Handedness)) + 
  geom_point (aes(color = Handedness), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  labs(fill = '', color = '')+
  scale_colour_manual("",values=c('orange', 'deepskyblue4', 'grey40'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4', 'grey40'))
handed_plot

```

#Screen size

```{r}

screen_subs <- demo.vars
screen_subs$Above<- ifelse(screen_subs$screensize > median(screen_subs$screensize), "Above Median", "Below Median")


screendata <- na.omit(full_join(ft.data, screen_subs, by = c("Subject.ID"))) %>% 
  group_by(TN, Block, FB, Above) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

screenplot <- p1 %+% screendata + aes(fill = factor(Above), group = interaction(factor(Block), factor(Above))) + 
  geom_point (aes(color = factor(Above)), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  labs(fill = '', color = '')+
  scale_colour_manual("",values=c('orange', 'deepskyblue4'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4'))
screenplot

```

#Directionality

```{r}

directiondata <- ft.data %>% 
  mutate(CCW = dplyr::if_else(CCW == TRUE, 'CCW', 'CW')) %>%
  group_by(TN, Block, FB, CCW) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

directionplot <- p1 %+% directiondata + aes(fill = factor(CCW), group = interaction(factor(Block), factor(CCW))) + 
  geom_point (aes(color = factor(CCW)), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  labs(fill = '', color = '')+
  scale_colour_manual("",values=c('orange', 'deepskyblue4'))+
  scale_fill_manual("",values=c('orange', 'deepskyblue4'))
directionplot
```

#Sleep

```{r}

sleepdata <- ft.data %>% 
  mutate(Sleep = dplyr::if_else(Sleep <= 6, '<6', '>=6')) %>%
  group_by(TN, Block, FB, Sleep) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

sleep <- p1 %+% sleepdata + aes(fill = factor(Sleep), group = interaction(factor(Block), factor(Sleep))) + 
  geom_point(aes(color = factor(Sleep)), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  labs(fill = 'Sleep(hours)', color = 'Sleep(hours)')+
  scale_color_manual( values = c("orange","deepskyblue4")) + 
  scale_fill_manual( values = c("orange",  "deepskyblue4"))
sleep

```

#Gaming

```{r}

compgamesdata <- ft.data %>%
  group_by(TN, Block, FB, videogames) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

game_plot <- p1 %+% compgamesdata + aes(fill = videogames, group = interaction(factor(Block), videogames)) + 
  geom_point(aes(color = videogames), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  labs(fill = 'Gaming Frequency', color = 'Gaming Frequency') +
  scale_color_gradient(low = "grey62", high = "deepskyblue4") + 
  scale_fill_gradient(low = "grey62", high = "deepskyblue4") 
game_plot


```

#Hours of Comp

```{r}

compusagedata <- ft.data %>% 
  group_by(TN, Block, FB, ComputerUsage) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) ) %>%
  drop_na()

compplot <- p1 %+% compusagedata + aes(fill = ComputerUsage, group = interaction(factor(Block), ComputerUsage)) + 
  geom_point(aes(color = ComputerUsage), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  scale_color_gradient() +
  scale_fill_gradient()
compplot
```

#Clumsy

```{r}

clumsydata <- ft.data %>% 
  group_by(TN, Block, FB, clumsy) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) )

clumsyplot <- p1 %+% clumsydata + aes(fill = clumsy, group = interaction(factor(Block), clumsy)) + 
  geom_point(aes(color = clumsy), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05)+
  scale_color_gradient(low = "grey62", high = "deepskyblue4") + 
  scale_fill_gradient(low = "grey62", high = "deepskyblue4")+
  theme(axis.text.x = element_text(angle = 45, hjust = 0.95))
clumsyplot

```

#Major

```{r}

majordata <- ft.data %>% 
  mutate(newmajor = major ) %>%
  group_by(TN, Block, FB, newmajor) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) ) 

majorplot <- p1 %+% majordata + aes(fill = newmajor, group = interaction(factor(Block), newmajor)) + 
  geom_point(aes(color = newmajor), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) + 
  labs(fill = '', color = '')+
  scale_colour_manual("",values=c( 'deepskyblue4','orange', 'grey40', 'firebrick4', 'salmon', 'darkolivegreen4'))+
  scale_fill_manual("",values=c( 'deepskyblue4', 'orange', 'grey40', 'firebrick4', 'salmon', 'darkolivegreen4'))
majorplot

```

#Race

```{r}

racedata <- ft.data %>% 
  filter(racialorigin %in% c('asian', 'white', 'multiple', 'latinx')) %>%
  group_by(TN, Block, FB, racialorigin) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) ) 

raceplot <-p1 %+% racedata + aes(fill = racialorigin, group = interaction(factor(Block), racialorigin)) + 
  geom_point(aes(color = racialorigin), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05) +
  scale_colour_manual("",values=c( 'deepskyblue4','orange', 'grey40', 'firebrick3'))+
  scale_fill_manual("",values=c( 'deepskyblue4', 'orange', 'grey40', 'firebrick3'))
raceplot

```

#Browser

```{r}

browserdata <- ft.data %>% 
  group_by(TN, Block, FB, browsertype) %>%
  dplyr::summarise(Hand_mean = mean(HandFlip, na.rm = TRUE), Hand_sem = std.error(HandFlip, na.rm = TRUE) ) 

browserplot <- p1 %+% browserdata + aes(fill = as.factor(browsertype), group = interaction(factor(Block), as.factor(browsertype))) + 
  geom_point(aes(color = as.factor(browsertype)), size = 0.5) + 
  geom_ribbon(aes(ymin = Hand_mean - Hand_sem, ymax = Hand_mean + Hand_sem), alpha = 0.05)
browserplot

```


